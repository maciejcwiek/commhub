!function(a){function b(){if(l.debug){var a=arguments;if("object"==typeof a){var b=null;a=[];for(b in arguments)arguments.hasOwnProperty(b)&&a.push(arguments[b])}a.reverse(),a.push(l.logPrefix),a.reverse(),console.log.apply(console,a)}}function c(a){return a=a||"uid_",a+""+(new Date).getTime()+parseInt(1e3*Math.random(),0)}function d(a){return a instanceof EventRouter||a&&a.constructor&&"EventRouter"===a.constructor.name}function e(a,b){this.id=c("eiid_"),this.event=b,this.module=a}function f(a){a=a||{},l.debug="boolean"==typeof a.verbose?a.verbose:!1,k=d(a.eventRouter)?a.eventRouter:{}}function g(a){return h=h instanceof f?h:new f(a)}var h={},i={},j={},k={},l={debug:!1,logPrefix:"[CommunicationHub]"};e.prototype.interceptEvent=function(a){a=a||!1;var c=this,d=this.module.handlers[this.event];try{b("Attempting to route event:",this.event,"[module: "+this.module.id+"]"),k.route(this.event,a,function(b){c.module.target[d].call(c.module.target,c.event,b||a)})}catch(e){b("EventRouter not found. Triggering handler for event:",this.event,"[module: "+this.module.id+"]",e.message),this.module.target[d].call(this.module.target,this.event,a)}};var m={_interceptors:{},create:function(a,c){return this._interceptors[a]=this._interceptors[a]||[],this._interceptors[a].push(new e(c,a)),b("Successfully created EventInterceptor for event:",a,"[module: "+c.id+"]"),this._interceptors[a][this._interceptors[a].length-1]},invokeInterceptor:function(a,c){var d=-1,e=this._interceptors[a]||[];if(!this._interceptors[a])return void b("No event interceptors found for event:",a);for(;e[++d];)e[d].interceptEvent(c)},removeAllInterceptors:function(){var a=null;for(a in this._interceptors)this._interceptors.hasOwnProperty(a)&&delete this._interceptors[a]}};f.prototype.registerModule=function(a){var b=c("mid_"),d=i[b]=a,e=null;d.id=b;for(e in d.handlers)j[e]=j[e]||[],j[e].push({module_id:b,interceptor_id:m.create(e,d).id})},f.prototype.emit=function(a,b){m.invokeInterceptor(a,b)},f.prototype.useRouter=function(a){if(!d(a))throw"Argument is not an instance of EventRouter class.";k=a},f.prototype.reset=function(){i={},j={},k={},m.removeAllInterceptors()},a.CommunicationHub=g}(GLOBAL||window);