!function(a,b){function c(){if(g.debug){var a=arguments;if("object"==typeof a){a=[];for(var b in arguments)arguments.hasOwnProperty(b)&&a.push(arguments[b])}a.reverse(),a.push(g.logPrefix),a.reverse(),console.log.apply(console,a)}}function d(){function a(a){return a=a||"uid_",a+""+(new Date).getTime()+parseInt(1e3*Math.random(),0)}function d(b,c){this.id=a("eiid_"),this.event=c,this.module=b}var e={},f={},g={},h={};d.prototype.interceptEvent=function(a){a=a||!1;var d=this,e=this.module.handlers[this.event];try{b.route(this.event,a,function(b){d.module.target[e].call(d.module.target,d.event,b||a)})}catch(f){c("EventRouter not found."),this.module.target[e].call(this.module.target,this.event,a)}},h={create:function(a,b){return g[a]=g[a]||[],g[a].push(new d(b,a)),g[a][g[a].length-1]},triggerEvent:function(a,b){for(var c=-1,d=g[a]||[];d[++c];)d[c].interceptEvent(b)}},this.registerModule=function(b){var c=a("mid_"),d=e[c]=b,g=null;d.id=c;for(g in d.handlers)f[g]=f[g]||[],f[g].push({module_id:c,interceptor_id:h.create(g,d).id})},this.emit=function(a,b){h.triggerEvent(a,b)}}function e(){return f=f instanceof d?f:new d(arguments)}var f=null,g={debug:!0,logPrefix:"[CommunicationHub]"};a.CommunicationHub=e}(GLOBAL||window,EventRouter);